//
//  ios13_change_offsets.c
//  ios13_app1
//
//  Created by bb on 1/25/20.
//  Copyright Â© 2020 bb. All rights reserved.
//


#include <stdio.h>
#include <setjmp.h>
#include <stdlib.h>
#include <sys/mman.h>
#include <sys/sysctl.h>
#include <sys/utsname.h>
#include <mach/mach.h>
#include <mach/thread_act.h>
#include <mach/semaphore.h>
#include <mach/mach_traps.h>
#include <mach/thread_status.h>
#include <pthread/pthread.h>
#include <IOSurface/IOSurfaceRef.h>
#include "IOKitLib.h"
#include <dirent.h>
#include <mach-o/dyld.h>
#include <sys/stat.h>
#import <Foundation/Foundation.h>
#import <UIKit/UIKit.h>

#pragma mark --- External API
//set share_analytics = false to disable analytics sharing
share_analytics = false;

#define SYSTEM_VERSION_EQUAL_TO(v)                  ([[[UIDevice currentDevice] systemVersion] compare:v options:NSNumericSearch] == NSOrderedSame)
#define SYSTEM_VERSION_GREATER_THAN(v)              ([[[UIDevice currentDevice] systemVersion] compare:v options:NSNumericSearch] == NSOrderedDescending)
#define SYSTEM_VERSION_GREATER_THAN_OR_EQUAL_TO(v)  ([[[UIDevice currentDevice] systemVersion] compare:v options:NSNumericSearch] != NSOrderedAscending)
#define SYSTEM_VERSION_LESS_THAN(v)                 ([[[UIDevice currentDevice] systemVersion] compare:v options:NSNumericSearch] == NSOrderedAscending)
#define SYSTEM_VERSION_LESS_THAN_OR_EQUAL_TO(v)     ([[[UIDevice currentDevice] systemVersion] compare:v options:NSNumericSearch] != NSOrderedDescending)

bool check_if_iOS_version_equal_to(const char *cmpto_version){
    CFStringRef cfstrwrap = CFStringCreateWithCString(kCFAllocatorDefault, cmpto_version, kCFStringEncodingUTF8);
    
    if (SYSTEM_VERSION_EQUAL_TO((__bridge NSString * _Nonnull)(cfstrwrap))) {
        return true;
    }
    
    CFRelease(cfstrwrap);
    return false;
}

bool check_if_iOS_version_greater_than_or_equal_to(const char *cmpto_version){
    CFStringRef cfstrwrap = CFStringCreateWithCString(kCFAllocatorDefault, cmpto_version, kCFStringEncodingUTF8);
    
    if (SYSTEM_VERSION_GREATER_THAN_OR_EQUAL_TO((__bridge NSString * _Nonnull)(cfstrwrap))) {
        return true;
    }
    
    CFRelease(cfstrwrap);
    return false;
}

bool check_if_iOS_version_less_then(const char *cmpto_version){
    CFStringRef cfstrwrap = CFStringCreateWithCString(kCFAllocatorDefault, cmpto_version, kCFStringEncodingUTF8);
    
    if (SYSTEM_VERSION_LESS_THAN((__bridge NSString * _Nonnull)(cfstrwrap))) {
        return true;
    }
    
    CFRelease(cfstrwrap);
    return false;
}

bool check_if_its_PAC_device(){
#if __arm64e__
    return true;
#endif
    return false;
}

bool check_if_amfid_has_entitParser(){
    if(check_if_iOS_version_greater_than_or_equal_to("13.5"))
        return true;
    return false;
}

char *_cur_deviceModel13 = NULL;
char *get_current_deviceModel13(){
    if(_cur_deviceModel13)
        return _cur_deviceModel13;
    struct utsname systemInfo;
    uname(&systemInfo);
    NSString* code = [NSString stringWithCString:systemInfo.machine
                                        encoding:NSUTF8StringEncoding];
    static NSDictionary* deviceNamesByCode = nil;
    if (!deviceNamesByCode) {
        deviceNamesByCode = @{  @"i386"      : @"Simulator",
                                @"x86_64"    : @"Simulator",
                                @"iPod1,1"   : @"iPod Touch",        // (Original)
                                @"iPod2,1"   : @"iPod Touch",        // (Second Generation)
                                @"iPod3,1"   : @"iPod Touch",        // (Third Generation)
                                @"iPod4,1"   : @"iPod Touch",        // (Fourth Generation)
                                @"iPod7,1"   : @"iPod Touch",        // (6th Generation)
                                @"iPhone1,1" : @"iPhone",            // (Original)
                                @"iPhone1,2" : @"iPhone",            // (3G)
                                @"iPhone2,1" : @"iPhone",            // (3GS)
                                @"iPad1,1"   : @"iPad",              // (Original)
                                @"iPad2,1"   : @"iPad 2",            //
                                @"iPad3,1"   : @"iPad",              // (3rd Generation)
                                @"iPhone3,1" : @"iPhone 4",          // (GSM)
                                @"iPhone3,3" : @"iPhone 4",          // (CDMA/Verizon/Sprint)
                                @"iPhone4,1" : @"iPhone 4S",         //
                                @"iPhone5,1" : @"iPhone 5",          // (model A1428, AT&T/Canada)
                                @"iPhone5,2" : @"iPhone 5",          // (model A1429, everything else)
                                @"iPad3,4"   : @"iPad",              // (4th Generation)
                                @"iPad2,5"   : @"iPad Mini",         // (Original)
                                @"iPhone5,3" : @"iPhone 5c",         // (model A1456, A1532 | GSM)
                                @"iPhone5,4" : @"iPhone 5c",         // (model A1507, A1516, A1526 (China), A1529 | Global)
                                @"iPhone6,1" : @"iPhone 5s",         // (model A1433, A1533 | GSM)
                                @"iPhone6,2" : @"iPhone 5s",         // (model A1457, A1518, A1528 (China), A1530 | Global)
                                @"iPhone7,1" : @"iPhone 6 Plus",     //
                                @"iPhone7,2" : @"iPhone 6",          //
                                @"iPhone8,1" : @"iPhone 6S",         //
                                @"iPhone8,2" : @"iPhone 6S Plus",    //
                                @"iPhone8,4" : @"iPhone SE",         //
                                @"iPhone9,1" : @"iPhone 7",          //
                                @"iPhone9,3" : @"iPhone 7",          //
                                @"iPhone9,2" : @"iPhone 7 Plus",     //
                                @"iPhone9,4" : @"iPhone 7 Plus",     //
                                @"iPhone10,1": @"iPhone 8",          // CDMA
                                @"iPhone10,4": @"iPhone 8",          // GSM
                                @"iPhone10,2": @"iPhone 8 Plus",     // CDMA
                                @"iPhone10,5": @"iPhone 8 Plus",     // GSM
                                @"iPhone10,3": @"iPhone X",          // CDMA
                                @"iPhone10,6": @"iPhone X",          // GSM
                                @"iPhone11,2": @"iPhone XS",         //
                                @"iPhone11,4": @"iPhone XS Max China",     //
                                @"iPhone11,6": @"iPhone XS Max",     // China
                                @"iPhone11,8": @"iPhone XR",         //
                                @"iPhone12,1": @"iPhone 11",         //
                                @"iPhone12,3": @"iPhone 11 Pro",     //
                                @"iPhone12,5": @"iPhone 11 Pro Max", //
                                @"iPhone12,8": @"iPhone SE (2nd generation)", //

                                //IPADs

                                @"iPad5,3": @"iPad Air (2nd generation Wifi)",//
                                @"iPad5,4": @"iPad Air (2nd generation cellular)",//
                                @"iPad11,3": @"iPad Air (3rd generation Wifi)",//same as mini5?
                                @"iPad11,4": @"iPad Air (3rd generation cellular)",//same as mini5?
                                @"iPad6,11": @"iPad (5th generation Wifi)",//
                                @"iPad6,12": @"iPad (5th generation cellular)",//
                                @"iPad7,5": @"iPad (6th generation Wifi)",//
                                @"iPad7,6": @"iPad (6th generation cellular)",//
                                @"iPad7,11": @"iPad (7th generation Wifi)",//
                                @"iPad7,12": @"iPad (7th generation cellular)",//
                                @"iPad5,1": @"iPad mini 4 Wifi",
                                @"iPad5,2": @"iPad mini 4 cellular",
                                @"iPad11,1": @"iPad mini (5th generation Wifi)",//same as air3?
                                @"iPad11,2": @"iPad mini (5th generation cellular)",//same as air3?
                                @"iPad6,3": @"iPad Pro (9.7) A1673",
                                @"iPad6,4": @"iPad Pro (9.7) Wifi",
                                @"iPad6,7": @"iPad Pro (12.9-inch) (1st generation wifi)",
                                @"iPad6,8": @"iPad Pro (12.9-inch) (1st generation cellular)",
                                @"iPad7,1": @"iPad Pro (12.9-inch) (2nd generation) wifi",//same as i7 kamp
                                @"iPad7,2": @"iPad Pro (12.9-inch) (2nd generation) cellular",//same as i7 kmap
                                @"iPad7,3": @"iPad Pro (10.5) Wifi",//same as i7
                                @"iPad7,4": @"iPad Pro (10.5) cellular",//same as i7
                                @"iPad8,1": @"iPad Pro (11-inch) (1st generation) wifi",
                                @"iPad8,2": @"iPad Pro (11-inch) (1st generation) cellular",
                                @"iPad8,3": @"iPad Pro (11-inch) (1st generation) wifi",
                                @"iPad8,4": @"iPad Pro (11-inch) (1st generation) cellular",
                                @"iPad8,5": @"iPad Pro (12.9-inch) (3rd generation) wifi",
                                @"iPad8,6": @"iPad Pro (12.9-inch) (3rd generation) cellular",
                                @"iPad8,7": @"iPad Pro (12.9-inch) (3rd generation) wifi",
                                @"iPad8,8": @"iPad Pro (12.9-inch) (3rd generation) cellular",
                                @"iPad8,9": @"iPad Pro (11-inch) (2nd generation) wifi",
                                @"iPad8,10": @"iPad Pro (11-inch) (2nd generation) cellular",
                                @"iPad8,11": @"iPad Pro (12.9-inch) (4th generation) wifi",
                                @"iPad8,12": @"iPad Pro (12.9-inch) (4th generation) cellular"
        };
    }
    NSString* deviceName = [deviceNamesByCode objectForKey:code];
    if (!deviceName) {
        // Not found on database. At least guess main device type from string contents:
        
        if ([code rangeOfString:@"iPod"].location != NSNotFound) {
            deviceName = @"iPod Touch";
        }
        else if([code rangeOfString:@"iPad"].location != NSNotFound) {
            deviceName = @"iPad";
        }
        else if([code rangeOfString:@"iPhone"].location != NSNotFound){
            deviceName = @"iPhone";
        }
        else {
            deviceName = @"Unknown";
        }
    }
    _cur_deviceModel13 = strdup([deviceName UTF8String]);
    return _cur_deviceModel13;
}


#pragma mark --- Hardcoded values

// HARDCODED addresses used in kernel
uint64_t HARDCODED_infoleak_addr = 0; // vtable of IOSurface
uint64_t HARDCODED_allproc = 0; // via IDA search pgrp_add : pgrp is dead adding process
uint64_t HARDCODED_kernel_map = 0; // via jtool2

// HARDCODED offsets used in kernel
uint32_t OFFSET_bsd_info_pid13 = 0x68; // +0x68:  bsd_info->pid
uint32_t OFFSET_bsd_info_task13 = 0x10; // +0x10:  bsd_info->task
uint32_t OFFSET_task_itk_task_access13 = 0x2F8; // +0x2F8:  task->itk_task_access (ios13.x)
uint32_t OFFSET_task_itk_registered = 0x308; // +0x308:  task->itk_registered (ios13.x)
uint32_t OFFSET_task_t_flags13; // for TF_PLATFORM Patch

// HARDCODED zone index used in kernel
uint32_t zone_index_ipc_ports = 42;
uint32_t zone_index_tasks = 58;

// --- following addr/offsets are post-exp

// HARDCODED addresses used in kernel for remount rootFS
uint64_t HARDCODED_jnodehash_mask = 0;
uint64_t HARDCODED_jjnodehashtbl = 0;
uint32_t OFFSET_bsd_info_p_fd = 0x108; // pac: 0x108
uint32_t OFFSET_fileproc_f_fglob = 0x10; // pac: 0x10 // for use of find_vnode_with_path
uint32_t OFFSET_fileglob_fg_data = 0x38; // pac: 0x38 // for use of find_vnode_with_path
uint32_t OFFSET_vnode_v_data = 0xE0; // pac: 0xE0 find the snapshot stru off a vnode, used in patch_snapshot_vnode
uint32_t OFFSET_vnode_v_mount = 0xD8; // pac: 0xD8 // for find the mount structure off a vnode
uint32_t OFFSET_mount_mnt_flag = 0x70; // pac: 0x70 // for remove read-only flag on mount stru

#pragma mark --- Check device

bool check_device_compatibility(){
    extern int Apply_hardcoded_addresses_and_offsets(void);
    
    if(Apply_hardcoded_addresses_and_offsets() == 0)
        return true;
    return false;
}

int Apply_hardcoded_addresses_and_offsets(){
    
    if(!strcmp(get_current_deviceModel13(), "iPhone X")){
        int apply_to_iPhone_X_global(void);
        return apply_to_iPhone_X_global();
    }
    else if(!strcmp(get_current_deviceModel13(), "iPhone 11")) {
        int apply_to_iPhone_11(void);
        return apply_to_iPhone_11();
    }
    else if(!strcmp(get_current_deviceModel13(), "iPhone 8")) {
        int apply_to_iPhone_8(void);
        return apply_to_iPhone_8();
    }

    else if(!strcmp(get_current_deviceModel13(), "iPhone XR")) {
        int apply_to_iPhone_Xr(void);
        return apply_to_iPhone_Xr();
    }
    else if(!strcmp(get_current_deviceModel13(), "iPhone 11 Pro Max")) {
        int apply_to_iPhone_11_pro_max(void);
        return apply_to_iPhone_11_pro_max();
    }
    else if(!strcmp(get_current_deviceModel13(), "iPhone 11 Pro")) {
        int apply_to_iPhone_11_pro(void);
        return apply_to_iPhone_11_pro();
    }
    else if(!strcmp(get_current_deviceModel13(), "iPhone 7 Plus")) {
        int apply_to_iPhone_7(void);
        return apply_to_iPhone_7();
    }

    else if(!strcmp(get_current_deviceModel13(), "iPhone 8 Plus")) {
        int apply_to_iPhone_8_plus_global(void);
        return apply_to_iPhone_8_plus_global();
    }

    else if(!strcmp(get_current_deviceModel13(), "iPhone SE")) {
        int apply_to_iPhone_SE(void);
        return apply_to_iPhone_SE();
    }
    else if(!strcmp(get_current_deviceModel13(), "iPhone SE (2nd generation)")) {
        int apply_to_iPhone_SE2020(void);
        return apply_to_iPhone_SE2020();
    }
    else if(!strcmp(get_current_deviceModel13(), "iPhone 7")) {
        int apply_to_iPhone_7(void);
        return apply_to_iPhone_7();
    }
    
    else if(!strcmp(get_current_deviceModel13(), "iPhone XS Max China")) {
        int apply_to_iPhone_XS_china(void);
        return apply_to_iPhone_XS_china();
    }
    else if((!strcmp(get_current_deviceModel13(), "iPhone XS Max")) || (!strcmp(get_current_deviceModel13(), "iPhone XS"))) {
        int apply_to_iPhone_XS(void);
        return apply_to_iPhone_XS();
    }
    else if(!strcmp(get_current_deviceModel13(), "iPad Pro (9.7\")")) {
        int apply_to_iPadPro_97_m64(void);
        return apply_to_iPadPro_97_m64();
    }
    else if(!strcmp(get_current_deviceModel13(), "iPad Pro (12.9\")")) {
        int apply_to_iPadPro_129_m68(void);
        return apply_to_iPadPro_129_m68();
    }
    else if((!strcmp(get_current_deviceModel13(), "iPad Pro (12.9-inch) (2nd generation) wifi")) || (!strcmp(get_current_deviceModel13(), "iPad Pro (12.9-inch) (2nd generation) cellular"))) {
        int apply_to_iPadPro_129_m68(void);
        return apply_to_iPadPro_129_m68();
    }
    else if((!strcmp(get_current_deviceModel13(), "iPad Pro (10.5) Wifi")) || (!strcmp(get_current_deviceModel13(), "iPad Pro (10.5) cellular"))) {
        int apply_to_iPadPro2_m73(void);
        return apply_to_iPadPro2_m73();
    }
    else if((!strcmp(get_current_deviceModel13(), "iPad (7th generation Wifi)")) || (!strcmp(get_current_deviceModel13(), "iPad (7th generation cellular)"))) {
        int apply_to_iPad7(void);
        return apply_to_iPad7();
    }
    else if((!strcmp(get_current_deviceModel13(), "iPhone 6S Plus")) || (!strcmp(get_current_deviceModel13(), "iPhone 6S"))){
        int apply_to_iPhone6sp(void);
        return apply_to_iPhone6sp();
    }
    else if((!strcmp(get_current_deviceModel13(), "iPad Mini 4 Wifi")) || (!strcmp(get_current_deviceModel13(), "iPad Mini 4 cellular"))) {
        int apply_to_iPadmini4(void);
        return apply_to_iPadmini4();
    }
    else if((!strcmp(get_current_deviceModel13(), "iPad Mini (5th generation Wifi)")) || (!strcmp(get_current_deviceModel13(), "iPad Mini (5th generation cellular)"))){
        int apply_to_iPadmini5(void);
        return apply_to_iPadmini5();
    }
    else if((!strcmp(get_current_deviceModel13(), "iPad Air (2nd generation Wifi)")) || (!strcmp(get_current_deviceModel13(), "iPad Air (2nd generation cellular)"))) {
        int apply_to_iPadAir2(void);
        return apply_to_iPadAir2();
    }
    else if((!strcmp(get_current_deviceModel13(), "iPad Air (3rd generation Wifi)")) || (!strcmp(get_current_deviceModel13(), "iPad Air (3rd generation cellular)"))) {
        int apply_to_iPadAir3(void);
        return apply_to_iPadAir3();
    }
    else {
        
        (printf)("Execution pause: Not found offsets set for current device(model: %s)\n", get_current_deviceModel13());
        return -1;
    }
}

#pragma mark --- iPhone SE 2020
int apply_to_iPhone_SE2020(){// zone index changes likely can apply to all PAC device
    OFFSET_task_t_flags13 = 0x3C0; // confirmed remains the same in iphonexs max(13.1.x ~ 13.3.x)
    zone_index_tasks = 59;
    if(check_if_iOS_version_greater_than_or_equal_to("13.4") && check_if_iOS_version_less_then("13.4.2")){
        zone_index_tasks = 59;// iOS 13.4
        HARDCODED_infoleak_addr = 0xFFFFFFF007A08240;//iPhone SE (2nd generation)
        HARDCODED_allproc = 0xFFFFFFF009469970;//iPhone SE (2nd generation)
        HARDCODED_kernel_map = 0xFFFFFFF0078dd678; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.5") && check_if_iOS_version_less_then("13.5.2")){
        zone_index_tasks = 59;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A0C250;
        HARDCODED_allproc = 0xFFFFFFF00946E1C0;
        HARDCODED_kernel_map = 0xfffffff0078e1678; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.7.1")) {
        zone_index_tasks = 59;// iOS 13.6/13.6.1 iphone xr only?
        HARDCODED_infoleak_addr = 0xFFFFFFF007A14260;
        HARDCODED_allproc = 0xFFFFFFF009469800;
        HARDCODED_kernel_map = 0xfffffff0078e9690; }
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1; }
    return 0;
}


#pragma mark --- iPhone Xr
int apply_to_iPhone_Xr(){
    OFFSET_task_t_flags13 = 0x3C0; // confirmed remains the same in iphonexs max(13.1.x ~ 13.3.x)
    zone_index_tasks = 57;
    if(check_if_iOS_version_greater_than_or_equal_to("13.3.1") && check_if_iOS_version_less_then("13.3.2")){
        HARDCODED_infoleak_addr = 0xFFFFFFF0078DF9E0;
        HARDCODED_allproc = 0xFFFFFFF0092DD930;
        HARDCODED_kernel_map = 0xfffffff007865768; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.4") && check_if_iOS_version_less_then("13.4.2")){
        zone_index_tasks = 59;
        HARDCODED_infoleak_addr = 0xFFFFFFF007913A18;
        HARDCODED_allproc = 0xFFFFFFF009321960;
        HARDCODED_kernel_map = 0xfffffff007899678; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.5") && check_if_iOS_version_less_then("13.5.2")){
        zone_index_tasks = 59;
        HARDCODED_infoleak_addr = 0xFFFFFFF0078F7A18;
        HARDCODED_allproc = 0xFFFFFFF0093061B0;//13.5.1 XR
        HARDCODED_kernel_map = 0xfffffff00787D678; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.7.1")){
        zone_index_tasks = 59;
        HARDCODED_infoleak_addr = 0xFFFFFFF0078FFA18;
        HARDCODED_allproc = 0xFFFFFFF0093057F0;
        HARDCODED_kernel_map = 0xfffffff007885690; }
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1; }
    return 0;
}
#pragma mark --- iPhone 11
int apply_to_iPhone_11(){
    OFFSET_task_t_flags13 = 0x3C0; // confirmed remains the same in iphonexs max(13.1.x ~ 13.3.x)
    zone_index_tasks = 59;
    if(check_if_iOS_version_greater_than_or_equal_to("13.3.1") && check_if_iOS_version_less_then("13.3.2")){
        HARDCODED_infoleak_addr = 0xFFFFFFF0079F4760;
        HARDCODED_allproc = 0xFFFFFFF009458940;
        HARDCODED_kernel_map = 0xfffffff0078d1768;
    }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.4") && check_if_iOS_version_less_then("13.4.2")){
        zone_index_tasks = 59;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A30C78;
        HARDCODED_allproc = 0xFFFFFFF0094A1970;
        HARDCODED_kernel_map = 0xFFFFFFF007909678;
    }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.5") && check_if_iOS_version_less_then("13.5.2")){
        zone_index_tasks = 59;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A10C88;
        HARDCODED_allproc = 0xFFFFFFF00947E1C0;
        HARDCODED_kernel_map = 0xfffffff0078E9678;
    }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.6.2")){
        zone_index_tasks = 59;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A18C98;
        HARDCODED_allproc = 0xFFFFFFF00947D800;
        HARDCODED_kernel_map = 0xfffffff0078F1690;
    }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.7") && check_if_iOS_version_less_then("13.7.1")){
        zone_index_tasks = 59;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A18C98; //iphone 11?
        HARDCODED_allproc = 0xFFFFFFF00947D800;//iphone 11?
        HARDCODED_kernel_map = 0xfffffff0078F1690;//iphone 11?
    }
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1;
    }
    return 0;
}

#pragma mark --- iPhone 8
int apply_to_iPhone_8(){
    OFFSET_task_t_flags13 = 0x3B8; // take from iphoneX 13.2.x, think it remains the same in all non-pac device
    zone_index_tasks = 60;
    if(check_if_iOS_version_greater_than_or_equal_to("13.2") && check_if_iOS_version_less_then("13.3")){
        HARDCODED_infoleak_addr = 0xfffffff007a10fb0;
        HARDCODED_allproc = 0xFFFFFFF0091EAC50;
        HARDCODED_kernel_map = 0xfffffff007905658; }
    else if(check_if_iOS_version_equal_to("13.3")){
        HARDCODED_infoleak_addr = 0xFFFFFFF007A150D0;
        HARDCODED_allproc = 0xFFFFFFF0091EEC30;
        HARDCODED_kernel_map = 0xfffffff007909658; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.3.1") && check_if_iOS_version_less_then("13.3.2")){
        HARDCODED_infoleak_addr = 0xFFFFFFF007A21150;
        HARDCODED_allproc = 0xFFFFFFF009232C30;
        HARDCODED_kernel_map = 0xfffffff007915658; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.4") && check_if_iOS_version_less_then("13.4.2")){
        zone_index_tasks = 60;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A5E7D8;
        HARDCODED_allproc = 0xFFFFFFF00926FC60;
        HARDCODED_kernel_map = 0xFFFFFFF00794D6A8; }
    else if(check_if_iOS_version_equal_to("13.4.5")){
        zone_index_tasks = 60;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A5E7D8;
        HARDCODED_allproc = 0xFFFFFFF00926FC60;
        HARDCODED_kernel_map = 0xFFFFFFF00794D6A8; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.5") && check_if_iOS_version_less_then("13.5.2")){
        zone_index_tasks = 60;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A45288;//i8_13.5//0xFFFFFFF007A427E8;
        HARDCODED_allproc = 0xFFFFFFF0092544B0;//0xFFFFFFF0092544B0;//i8    //-ix
        HARDCODED_kernel_map = 0xfffffff0079316a8; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.6.2")){
        zone_index_tasks = 60;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A45298;
        HARDCODED_allproc = 0xFFFFFFF009257AB0;
        HARDCODED_kernel_map = 0xfffffff0079316c0; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.7") && check_if_iOS_version_less_then("13.7.1")){
        zone_index_tasks = 60;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A23BE0;
        HARDCODED_allproc = 0xFFFFFFF009236C30;
        HARDCODED_kernel_map = 0xfffffff007915658; }
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1; }
    return 0;
}

#pragma mark --- iPhone X

int apply_to_iPhone_X_global(){ //need to do
    
    OFFSET_task_t_flags13 = 0x3B8; // take from iphoneX 13.2.x, think it remains the same in all non-pac device
    zone_index_tasks = 60;
    if(check_if_iOS_version_greater_than_or_equal_to("13.2") && check_if_iOS_version_less_then("13.3")){
        HARDCODED_infoleak_addr = 0xfffffff007a10fb0;
        HARDCODED_allproc = 0xFFFFFFF0091EAC50;
        HARDCODED_kernel_map = 0xfffffff007905658;
    }
    else if(check_if_iOS_version_equal_to("13.3")){
        HARDCODED_infoleak_addr = 0xFFFFFFF007A150D0;
        HARDCODED_allproc = 0xFFFFFFF0091EEC30;
        HARDCODED_kernel_map = 0xfffffff007909658;
        HARDCODED_jnodehash_mask = 0xFFFFFFF009225CD4;
        HARDCODED_jjnodehashtbl = 0xFFFFFFF009225CD8;
    }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.3.1") && check_if_iOS_version_less_then("13.3.2")){
        // iOS 13.3.1 on iPhone X
        HARDCODED_infoleak_addr = 0xFFFFFFF007A21150;
        HARDCODED_allproc = 0xFFFFFFF009232C30;
        HARDCODED_kernel_map = 0xfffffff007915658;
        HARDCODED_jnodehash_mask = 0xFFFFFFF009269CD4;
        HARDCODED_jjnodehashtbl = 0xFFFFFFF009269CD8;
    }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.4") && check_if_iOS_version_less_then("13.4.2")){
        zone_index_tasks = 60;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A5E7D8;
        HARDCODED_allproc = 0xFFFFFFF00926FC60;
        HARDCODED_kernel_map = 0xFFFFFFF00794D6A8;
    }
    else if(check_if_iOS_version_equal_to("13.4.5")){
        zone_index_tasks = 60;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A5E7D8;
        HARDCODED_allproc = 0xFFFFFFF00926FC60;
        HARDCODED_kernel_map = 0xFFFFFFF00794D6A8;
    }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.5") && check_if_iOS_version_less_then("13.5.2")){
        zone_index_tasks = 60;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A427E8;
        HARDCODED_allproc = 0xFFFFFFF0092544B0;
        HARDCODED_kernel_map = 0xfffffff0079316a8;
    }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.6.2")){
        zone_index_tasks = 60;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A427F8;
        HARDCODED_allproc = 0xFFFFFFF009257AB0;
        HARDCODED_kernel_map = 0xfffffff0079316c0;
    }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.7") && check_if_iOS_version_less_then("13.7.1")){
        zone_index_tasks = 60;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A427F8;
        HARDCODED_allproc = 0xFFFFFFF009257AB0;
        HARDCODED_kernel_map = 0xfffffff0079316c0;
    }
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1;
    }
    return 0;
}

int apply_to_iPhone_X(){
    OFFSET_task_t_flags13 = 0x3B8; // take from iphoneX 13.2.x, think it remains the same in all non-pac device
    zone_index_tasks = 60;
    if(check_if_iOS_version_greater_than_or_equal_to("13.2") && check_if_iOS_version_less_then("13.3")){
        HARDCODED_infoleak_addr = 0xfffffff007a10fb0;
        HARDCODED_allproc = 0xFFFFFFF0091EAC50;
        HARDCODED_kernel_map = 0xfffffff007905658; }
    else if(check_if_iOS_version_equal_to("13.3")){
        HARDCODED_infoleak_addr = 0xFFFFFFF007A150D0;
        HARDCODED_allproc = 0xFFFFFFF0091EEC30;
        HARDCODED_kernel_map = 0xfffffff007909658;
        HARDCODED_jnodehash_mask = 0xFFFFFFF009225CD4;
        HARDCODED_jjnodehashtbl = 0xFFFFFFF009225CD8; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.3.1") && check_if_iOS_version_less_then("13.3.2")){
        HARDCODED_infoleak_addr = 0xFFFFFFF007A21150;
        HARDCODED_allproc = 0xFFFFFFF009232C30;
        HARDCODED_kernel_map = 0xfffffff007915658;
        HARDCODED_jnodehash_mask = 0xFFFFFFF009269CD4;
        HARDCODED_jjnodehashtbl = 0xFFFFFFF009269CD8; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.4") && check_if_iOS_version_less_then("13.4.2")){
        HARDCODED_infoleak_addr = 0xFFFFFFF007A5E7D8;
        HARDCODED_allproc = 0xFFFFFFF00926FC60;
        HARDCODED_kernel_map = 0xFFFFFFF00794D6A8; }
    else if(check_if_iOS_version_equal_to("13.4.5")){
        HARDCODED_infoleak_addr = 0xFFFFFFF007A5E7D8;
        HARDCODED_allproc = 0xFFFFFFF00926FC60;
        HARDCODED_kernel_map = 0xFFFFFFF00794D6A8; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.5") && check_if_iOS_version_less_then("13.5.2")){
        HARDCODED_infoleak_addr = 0xFFFFFFF007A427E8;
        HARDCODED_allproc = 0xFFFFFFF0092544B0;
        HARDCODED_kernel_map = 0xfffffff0079316a8; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.6.2")){
        HARDCODED_infoleak_addr = 0xFFFFFFF007A427F8;
        HARDCODED_allproc = 0xFFFFFFF009257AB0;
        HARDCODED_kernel_map = 0xfffffff0079316c0; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.7") && check_if_iOS_version_less_then("13.7.1")){
        HARDCODED_infoleak_addr = 0xFFFFFFF007A427F8;
        HARDCODED_allproc = 0xFFFFFFF009257AB0;
        HARDCODED_kernel_map = 0xfffffff0079316c0; }
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1; }
    return 0;
}

#pragma mark --- iPhone 11 Pro Max

int apply_to_iPhone_11_pro_max(){
    OFFSET_task_t_flags13 = 0x3C0; // confirmed remains the same in iphonexs max(13.1.x ~ 13.3.x)
    zone_index_tasks = 57;
    if(check_if_iOS_version_greater_than_or_equal_to("13.3.1") && check_if_iOS_version_less_then("13.3.2")){
        HARDCODED_infoleak_addr = 0xFFFFFFF0079F4760;//checks good
        HARDCODED_allproc = 0xFFFFFFF00945C940;//checks good
        HARDCODED_kernel_map = 0xfffffff0078d1768; } //checks good
    else if(check_if_iOS_version_greater_than_or_equal_to("13.4") && check_if_iOS_version_less_then("13.4.2")){
        zone_index_tasks = 59;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A30C78;//checks good
        HARDCODED_allproc = 0xFFFFFFF0094A5970;//checks good
        HARDCODED_kernel_map = 0xFFFFFFF007909678; }//checks good
    else if(check_if_iOS_version_greater_than_or_equal_to("13.5") && check_if_iOS_version_less_then("13.5.2")){
        zone_index_tasks = 59;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A10C88;
        HARDCODED_allproc = 0xFFFFFFF0094821C0;//checks good
        HARDCODED_kernel_map = 0xfffffff0078e9678; }//checks good
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.6.2")){
        zone_index_tasks = 59;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A18C98;
        HARDCODED_allproc = 0xFFFFFFF009481800;
        HARDCODED_kernel_map = 0xfffffff0078f1690; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.7") && check_if_iOS_version_less_then("13.7.1")){
        zone_index_tasks = 59;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A18C98;//vtableforiosurface
        HARDCODED_allproc = 0xFFFFFFF009481800;//pgrp:deadass processing
        HARDCODED_kernel_map = 0xfffffff0078f1690; }
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1; }
    return 0;
}

#pragma mark --- iPhone 11 Pro

int apply_to_iPhone_11_pro(){
    OFFSET_task_t_flags13 = 0x3C0; // confirmed remains the same in iphonexs max(13.1.x ~ 13.3.x)
    zone_index_tasks = 57;
    if(check_if_iOS_version_greater_than_or_equal_to("13.3.1") && check_if_iOS_version_less_then("13.3.2")){
        HARDCODED_infoleak_addr = 0xFFFFFFF0079F4760;//79039E0;//i11 PRo _12,3
        HARDCODED_allproc = 0xFFFFFFF00945C940;//0xFFFFFFF0093A1C58;//i11 PRo _11//0xFFFFFFF00945C940
        HARDCODED_kernel_map = 0xfffffff0078d1768; }//007889768; }//0xFFFFFFF0078D1768
    else if(check_if_iOS_version_greater_than_or_equal_to("13.4") && check_if_iOS_version_less_then("13.4.2")){
        zone_index_tasks = 59;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A30C78;//7937A18;//i11 PRo _11
        HARDCODED_allproc = 0xFFFFFFF0094A5970;//0xFFFFFFF0093CE960;
        HARDCODED_kernel_map = 0xfffffff007909678; }//FFFFFFF0078bd678; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.5") && check_if_iOS_version_less_then("13.5.2")){
        zone_index_tasks = 59;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A10C88;//i11 PRo _12,3checks out good
        HARDCODED_allproc = 0xFFFFFFF0094821C0;//i11 PRo _12,3 checks out good
        HARDCODED_kernel_map = 0xfffffff0078e9678; }//checksout
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.7.1")){
        zone_index_tasks = 59;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A18C98; //checkout
        HARDCODED_allproc = 0xFFFFFFF009481800;//checks out
        HARDCODED_kernel_map = 0xfffffff0078f1690; }//checks out good
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1; }
    return 0;
}

int apply_to_iPhone_8_plus_global(){ //need to do
    
    OFFSET_task_t_flags13 = 0x3B8; // confirmed remains the same in iphonexs max(13.1.x ~ 13.3.x)
    zone_index_tasks = 58;
    if(check_if_iOS_version_greater_than_or_equal_to("13.2") && check_if_iOS_version_less_then("13.3")){
        HARDCODED_infoleak_addr = 0xFFFFFFF006DC4DF8;////0xFFFFFFF006DC42C0;//i7_13.2.3
        HARDCODED_allproc = 0xFFFFFFF007767880;//0xFFFFFFF007766BE0;
        HARDCODED_kernel_map = 0xfffffff0070d0aa8; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.3.1") && check_if_iOS_version_less_then("13.3.2")){
        HARDCODED_infoleak_addr = 0xfffffff006dc4f38;
        HARDCODED_allproc = 0xFFFFFFF007767860;
        HARDCODED_kernel_map = 0xfffffff0070d0aa8; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.4") && check_if_iOS_version_less_then("13.4.2")){
       zone_index_tasks = 60;
       HARDCODED_infoleak_addr = 0xFFFFFFF007A5E7D8;
       HARDCODED_allproc = 0xFFFFFFF00926FC60;
       HARDCODED_kernel_map = 0xFFFFFFF00794D6A8; }
    else if(check_if_iOS_version_equal_to("13.4.5")){
       zone_index_tasks = 60;
       HARDCODED_infoleak_addr = 0xFFFFFFF007A5E7D8;
       HARDCODED_allproc = 0xFFFFFFF00926FC60;
       HARDCODED_kernel_map = 0xFFFFFFF00794D6A8; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.5") && check_if_iOS_version_less_then("13.5.2")){
       zone_index_tasks = 60;
       HARDCODED_infoleak_addr = 0xFFFFFFF007A45288;//i8+_gsm vtableforiosurface
       HARDCODED_allproc = 0xFFFFFFF0092544B0; //i8+_global pgrp:deadass
       HARDCODED_kernel_map = 0xfffffff0079316a8; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.7.1")){
       zone_index_tasks = 60;
       HARDCODED_infoleak_addr = 0xFFFFFFF007A45298;//i8+_global vtableforiosurface
       HARDCODED_allproc = 0xFFFFFFF009257AB0;//i8+_global pgrp:deadass
       HARDCODED_kernel_map = 0xfffffff0079316c0; }
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1; }
    return 0;
}

int apply_to_iPhone_7(){
    OFFSET_task_t_flags13 = 0x3B8; // confirmed remains the same in iphonexs max(13.1.x ~ 13.3.x)
    zone_index_tasks = 58;
    if(check_if_iOS_version_greater_than_or_equal_to("13.2") && check_if_iOS_version_less_then("13.3")){
        HARDCODED_infoleak_addr = 0xFFFFFFF006DC4DF8;////0xFFFFFFF006DC42C0;//i7_13.2.3
        HARDCODED_allproc = 0xFFFFFFF007767880;//0xFFFFFFF007766BE0;
        HARDCODED_kernel_map = 0xfffffff0070d0aa8; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.3.1") && check_if_iOS_version_less_then("13.3.2")){
        HARDCODED_infoleak_addr = 0xfffffff006dc4f38;
        HARDCODED_allproc = 0xFFFFFFF007767860;
        HARDCODED_kernel_map = 0xfffffff0070d0aa8; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.4") && check_if_iOS_version_less_then("13.4.2")){
       zone_index_tasks = 60;
       HARDCODED_infoleak_addr = 0xFFFFFFF007A5E7D8;
       HARDCODED_allproc = 0xFFFFFFF00926FC60;
       HARDCODED_kernel_map = 0xFFFFFFF00794D6A8; }
    else if(check_if_iOS_version_equal_to("13.4.5")){
       zone_index_tasks = 60;
       HARDCODED_infoleak_addr = 0xFFFFFFF007A5E7D8;
       HARDCODED_allproc = 0xFFFFFFF00926FC60;
       HARDCODED_kernel_map = 0xFFFFFFF00794D6A8; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.5.1") && check_if_iOS_version_less_then("13.5.2")){
       zone_index_tasks = 60;
       HARDCODED_infoleak_addr = 0xFFFFFFF006DBCEF8;//i7 gsm vtableforiosurface
       HARDCODED_allproc = 0xFFFFFFF00776D960;//i7 gsm pgrp:deadass
       HARDCODED_kernel_map = 0xfffffff0070d0a78; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.7.1")){
       zone_index_tasks = 60;
       HARDCODED_infoleak_addr = 0xFFFFFFF006DBCEF8;//i7 gsm vtableforiosurface
       HARDCODED_allproc = 0xFFFFFFF007770FA0;//i7 gsm pgrp:deadass
       HARDCODED_kernel_map = 0xfffffff0070d0a90; }
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1; }
    return 0;
}

int apply_to_iPhone_XS_china(){//need to do
    OFFSET_task_t_flags13 = 0x3C0; // confirmed remains the same in iphonexs max(13.1.x ~ 13.3.x)
    if(check_if_iOS_version_greater_than_or_equal_to("13.4") && check_if_iOS_version_less_then("13.4.2")){
        zone_index_tasks = 59;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A30C78;
        HARDCODED_allproc = 0xFFFFFFF0094A5970;
        HARDCODED_kernel_map = 0xFFFFFFF007909678; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.5") && check_if_iOS_version_less_then("13.5.2")){
        zone_index_tasks = 59;
        HARDCODED_infoleak_addr = 0xFFFFFFF007917A18;
        HARDCODED_allproc = 0xFFFFFFF0093AB1B0;
        HARDCODED_kernel_map = 0xfffffff00789d678; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.7.1")){
        zone_index_tasks = 59;
        HARDCODED_infoleak_addr = 0xFFFFFFF00791FA18;
        HARDCODED_allproc = 0xFFFFFFF0093AA7F0;
        HARDCODED_kernel_map = 0xfffffff0078a5690; }
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1; }
    return 0;
}

int apply_to_iPhone_XS(){//XS MAX ALSO
    OFFSET_task_t_flags13 = 0x3C0; // confirmed remains the same in iphonexs max(13.1.x ~ 13.3.x)
    if(check_if_iOS_version_greater_than_or_equal_to("13.4") && check_if_iOS_version_less_then("13.4.2")){
        zone_index_tasks = 59;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A30C78;
        HARDCODED_allproc = 0xFFFFFFF0094A5970;
        HARDCODED_kernel_map = 0xFFFFFFF007909678; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.5") && check_if_iOS_version_less_then("13.5.2")){
        zone_index_tasks = 59;
        HARDCODED_infoleak_addr = 0xFFFFFFF007917A18;
        HARDCODED_allproc = 0xFFFFFFF0093AB1B0;
        HARDCODED_kernel_map = 0xfffffff00789d678; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.7.1")){
        zone_index_tasks = 59;
        HARDCODED_infoleak_addr = 0xFFFFFFF00791FA18;
        HARDCODED_allproc = 0xFFFFFFF0093AA7F0;
        HARDCODED_kernel_map = 0xfffffff0078a5690; }
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1; }
    return 0;
}

int apply_to_iPhone_SE(){
    
    OFFSET_task_t_flags13 = 0x3B8; // confirmed remains the same in iphonexs max(13.1.x ~ 13.3.x)
    zone_index_tasks = 58;
    if(check_if_iOS_version_greater_than_or_equal_to("13.2") && check_if_iOS_version_less_then("13.3")){
        HARDCODED_infoleak_addr = 0xFFFFFFF006DC4DF8;////0xFFFFFFF006DC42C0;//i7_13.2.3
        HARDCODED_allproc = 0xFFFFFFF007767880;//0xFFFFFFF007766BE0;
        HARDCODED_kernel_map = 0xfffffff0070d0aa8; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.3.1") && check_if_iOS_version_less_then("13.3.2")){
        HARDCODED_infoleak_addr = 0xfffffff006dc4f38;
        HARDCODED_allproc = 0xFFFFFFF007767860;
        HARDCODED_kernel_map = 0xfffffff0070d0aa8; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.4") && check_if_iOS_version_less_then("13.4.2")){
        zone_index_tasks = 60;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A5E7D8;
        HARDCODED_allproc = 0xFFFFFFF00926FC60;
        HARDCODED_kernel_map = 0xFFFFFFF00794D6A8; }
    else if(check_if_iOS_version_equal_to("13.4.5")){
        zone_index_tasks = 60;
        HARDCODED_infoleak_addr = 0xFFFFFFF007A5E7D8;
        HARDCODED_allproc = 0xFFFFFFF00926FC60;
        HARDCODED_kernel_map = 0xFFFFFFF00794D6A8; }

    else if(check_if_iOS_version_greater_than_or_equal_to("13.5") && check_if_iOS_version_less_then("13.5.2")){
       zone_index_tasks = 60;
       HARDCODED_infoleak_addr = 0xFFFFFFF006E6A238;//SE
       HARDCODED_allproc = 0xFFFFFFF00772D950;//se
       HARDCODED_kernel_map = 0xfffffff0076B4020; }
  //  else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.6.2")){
   //     HARDCODED_infoleak_addr = 0xFFFFFFF006DBCEF8;
   //     HARDCODED_allproc = 0xFFFFFFF007770FA0;
    //    HARDCODED_kernel_map = 0xFFFFFFF0070D0A90; }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.7.1")){
       zone_index_tasks = 60;
       HARDCODED_infoleak_addr = 0xFFFFFFF007A427F8;
       HARDCODED_allproc = 0xFFFFFFF009257AB0;
       HARDCODED_kernel_map = 0xfffffff0079316c0; }
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1; }
    
    return 0;
}

#pragma mark --- ipad pro 9.7 inch 6,3 6,4

int apply_to_iPadPro_97_m64(){
    
    OFFSET_task_t_flags13 = 0x3B8; // take from iphoneX 13.2.x, think it remains the same in all non-pac device
    zone_index_tasks = 60;

    // zone index changes likely can apply to all PAC device
    //zone_index_tasks = 58;
    if(check_if_iOS_version_greater_than_or_equal_to("13.5.1") && check_if_iOS_version_less_then("13.5.2")){
         
        // iOS 13.5.1 ipad pro 9.7 6,4
      //HARDCODED_infoleak_addr = 0xfffffff006dc4f38;FFFFFFF006DC42C0
        HARDCODED_infoleak_addr = 0xFFFFFFF006E16AB8;//iOS 13.5.1 ipad pro 9.7 6,4 6,3
        //HARDCODED_allproc = 0xFFFFFFF007766BD0;//i7_13.2.3
        HARDCODED_allproc = 0xFFFFFFF00772D950;//ipad pro 0.7 13.5.1 6,3; same as SE?
        HARDCODED_kernel_map = 0xfffffff007094cd8;// iOS 13.5.1 ipad pro 9.7 6,4
    }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.7.1")){
         zone_index_tasks = 60;

        // iOS 13.6/13.6.1
        HARDCODED_infoleak_addr = 0xFFFFFFF006E16AB8;//ipad pro 0.7 13.5.1 6,3;  same as 13.5.1
        HARDCODED_allproc = 0xFFFFFFF00772CF90;//ipad pro 0.7 13.5.1 6,3;
        HARDCODED_kernel_map = 0xfffffff007094cf0;//ipad pro 0.7 13.5.1 6,3;  0070d1b10 ipad pro2 7,3
    }
 
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1;
    }
    
    return 0;
}

#pragma mark --- ipad pro 12.9 inch 6,8

int apply_to_iPadPro_129_m68(){
    
    OFFSET_task_t_flags13 = 0x3B8; // take from iphoneX 13.2.x, think it remains the same in all non-pac device
    zone_index_tasks = 60;

    // zone index changes likely can apply to all PAC device
    //zone_index_tasks = 58;
    if(check_if_iOS_version_greater_than_or_equal_to("13.5.1") && check_if_iOS_version_less_then("13.5.2")){
         
        // iOS 13.5.1 ipad pro 9.7 6,4
      //HARDCODED_infoleak_addr = 0xfffffff006dc4f38;FFFFFFF006DC42C0
        HARDCODED_infoleak_addr = 0xFFFFFFF006DC4DF8;////0xFFFFFFF006DC42C0;//i7_13.2.3
        //HARDCODED_allproc = 0xFFFFFFF007766BD0;//i7_13.2.3
        HARDCODED_allproc = 0xFFFFFFF007767880;//0xFFFFFFF007766BE0;
        HARDCODED_kernel_map = 0xfffffff007094cd8;// iOS 13.5.1 ipad pro 9.7 6,4
    }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.7.1")){
         zone_index_tasks = 60;

        // iOS 13.6/13.6.1
        HARDCODED_infoleak_addr = 0xFFFFFFF006DBCEF8;
        HARDCODED_allproc = 0xFFFFFFF007770FA0;
        HARDCODED_kernel_map = 0xfffffff007094cf0;
    }
 
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1;
    }
    
    return 0;
}


#pragma mark --- ipad pro 2 12.9 inch

int apply_to_iPadPro2_m71(){
    
    OFFSET_task_t_flags13 = 0x3B8; // take from iphoneX 13.2.x, think it remains the same in all non-pac device
    zone_index_tasks = 60;

    // zone index changes likely can apply to all PAC device
    //zone_index_tasks = 58;
    if(check_if_iOS_version_greater_than_or_equal_to("13.5.1") && check_if_iOS_version_less_then("13.5.2")){
        // iOS 13.5.1 ipad pro 9.7 6,4
        HARDCODED_infoleak_addr = 0xFFFFFFF006DC4DF8;////0xFFFFFFF006DC42C0;//i7_13.2.3
        HARDCODED_allproc = 0xFFFFFFF007767880;//0xFFFFFFF007766BE0;
        HARDCODED_kernel_map = 0xfffffff0070d0a78;// iOS 13.5.1 ipad pro 2 7,1
    }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.7.1")){
         zone_index_tasks = 60;
        // iOS 13.6/13.6.1
        HARDCODED_infoleak_addr = 0xFFFFFFF006DBCEF8;
        HARDCODED_allproc = 0xFFFFFFF007770FA0;
        HARDCODED_kernel_map = 0xfffffff007094cf0;// 0070d1b10 ipad pro2 7,3
    }
 
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1;
    }
    
    return 0;
}

#pragma mark --- ipad pro 2 10.5 inch

int apply_to_iPadPro2_m73(){
    
    OFFSET_task_t_flags13 = 0x3B8; // take from iphoneX 13.2.x, think it remains the same in all non-pac device
    zone_index_tasks = 60;

    // zone index changes likely can apply to all PAC device
    //zone_index_tasks = 58;
    if(check_if_iOS_version_greater_than_or_equal_to("13.5") && check_if_iOS_version_less_then("13.5.2")){
        // iOS 13.5.1 ipad pro 9.7 6,4
        HARDCODED_infoleak_addr = 0xFFFFFFF006DE8EF8;// 13.5.1
        HARDCODED_allproc = 0xFFFFFFF00776D970;//
        HARDCODED_kernel_map = 0xfffffff0070d0a78;// fffffff0070d0a78 iOS 13.5.1 ipad pro 7,1 7,2 7,3 7,4
    }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.7.1")){
         zone_index_tasks = 60;
        // iOS 13.6/13.6.1
        HARDCODED_infoleak_addr = 0xFFFFFFF006DE8EF8;
        HARDCODED_allproc = 0xFFFFFFF007770FB0;//ipad10.5_13.6.1
        HARDCODED_kernel_map = 0xfffffff0070d0a90;//
    }
 
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1;
    }
    
    return 0;
}

#pragma mark --- ipad mini4

int apply_to_iPadmini4(){
    
    OFFSET_task_t_flags13 = 0x3B8; // take from iphoneX 13.2.x, think it remains the same in all non-pac device
    zone_index_tasks = 60;

    // zone index changes likely can apply to all PAC device
    //zone_index_tasks = 58;
    if(check_if_iOS_version_greater_than_or_equal_to("13.5.1") && check_if_iOS_version_less_then("13.5.2")){
         
        // iOS 13.5.1 ipad pro 9.7 6,4
      //HARDCODED_infoleak_addr = 0xfffffff006dc4f38;FFFFFFF006DC42C0
        HARDCODED_infoleak_addr = 0xFFFFFFF006DC4DF8;////0xFFFFFFF006DC42C0;//i7_13.2.3
        //HARDCODED_allproc = 0xFFFFFFF007766BD0;//i7_13.2.3
        HARDCODED_allproc = 0xFFFFFFF007767880;//0xFFFFFFF007766BE0;
        HARDCODED_kernel_map = 0xfffffff007094cd8;// iOS 13.5.1 ipad mini 5,1
    }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.7.1")){
         zone_index_tasks = 60;

        // iOS 13.6/13.6.1
        HARDCODED_infoleak_addr = 0xFFFFFFF006DBCEF8;
        HARDCODED_allproc = 0xFFFFFFF007770FA0;
        HARDCODED_kernel_map = 0xfffffff007094cf0;
    }
 
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1;
    }
    
    return 0;
}

#pragma mark --- ipad mini5

int apply_to_iPadmini5(){
    
    OFFSET_task_t_flags13 = 0x3B8; // take from iphoneX 13.2.x, think it remains the same in all non-pac device
    zone_index_tasks = 60;

    // zone index changes likely can apply to all PAC device
    //zone_index_tasks = 58;
    if(check_if_iOS_version_greater_than_or_equal_to("13.5.1") && check_if_iOS_version_less_then("13.5.2")){
         
        // iOS 13.5.1 ipad pro 9.7 6,4
      //HARDCODED_infoleak_addr = 0xfffffff006dc4f38;FFFFFFF006DC42C0
        HARDCODED_infoleak_addr = 0xFFFFFFF006DC4DF8;////0xFFFFFFF006DC42C0;//i7_13.2.3
        //HARDCODED_allproc = 0xFFFFFFF007766BD0;//i7_13.2.3
        HARDCODED_allproc = 0xFFFFFFF007767880;//0xFFFFFFF007766BE0;
        HARDCODED_kernel_map = 0xfffffff007094cd8;// iOS 13.5.1 ipad pro 9.7 6,4
    }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.7.1")){
         zone_index_tasks = 60;

        // iOS 13.6/13.6.1
        HARDCODED_infoleak_addr = 0xFFFFFFF006DBCEF8;
        HARDCODED_allproc = 0xFFFFFFF007770FA0;
        HARDCODED_kernel_map = 0xfffffff007094cf0;
    }
 
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1;
    }
    
    return 0;
}

#pragma mark --- ipad Air2

int apply_to_iPadAir2(){
    
    OFFSET_task_t_flags13 = 0x3B8; // take from iphoneX 13.2.x, think it remains the same in all non-pac device
    zone_index_tasks = 60;

    // zone index changes likely can apply to all PAC device
    //zone_index_tasks = 58;
    if(check_if_iOS_version_greater_than_or_equal_to("13.5.1") && check_if_iOS_version_less_then("13.5.2")){
         
        // iOS 13.5.1 ipad pro 9.7 6,4
      //HARDCODED_infoleak_addr = 0xfffffff006dc4f38;FFFFFFF006DC42C0
        HARDCODED_infoleak_addr = 0xFFFFFFF006DC4DF8;////0xFFFFFFF006DC42C0;//i7_13.2.3
        //HARDCODED_allproc = 0xFFFFFFF007766BD0;//i7_13.2.3
        HARDCODED_allproc = 0xFFFFFFF007767880;//0xFFFFFFF007766BE0;
        HARDCODED_kernel_map = 0xfffffff007094cd8;// iOS 13.5.1 ipad air 2 - 5,3 5,4 and ipad mini4 5,1 5,2
    }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.7.1")){
         zone_index_tasks = 60;

        // iOS 13.6/13.6.1
        HARDCODED_infoleak_addr = 0xFFFFFFF006DBCEF8;
        HARDCODED_allproc = 0xFFFFFFF007770FA0;
        HARDCODED_kernel_map = 0xfffffff007094cf0;
    }
 
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1;
    }
    
    return 0;
}

#pragma mark --- ipad Air3

int apply_to_iPadAir3(){
    
    OFFSET_task_t_flags13 = 0x3B8; // take from iphoneX 13.2.x, think it remains the same in all non-pac device
    zone_index_tasks = 60;
    if(check_if_iOS_version_greater_than_or_equal_to("13.5.1") && check_if_iOS_version_less_then("13.5.2")){
        HARDCODED_infoleak_addr = 0xFFFFFFF006DC4DF8;////0xFFFFFFF006DC42C0;//i7_13.2.3
        HARDCODED_allproc = 0xFFFFFFF007767880;//0xFFFFFFF007766BE0;
        HARDCODED_kernel_map = 0xfffffff007094cd8;// iOS 13.5.1 ipad pro 9.7 6,4
    }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.7.1")){
         zone_index_tasks = 60;
        HARDCODED_infoleak_addr = 0xFFFFFFF006DBCEF8;
        HARDCODED_allproc = 0xFFFFFFF007770FA0;
        HARDCODED_kernel_map = 0xfffffff007094cf0;
    }
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1;
    }
    return 0;
}

#pragma mark --- ipad 7th gen

int apply_to_iPad7(){
    
    OFFSET_task_t_flags13 = 0x3B8; // take from iphoneX 13.2.x, think it remains the same in all non-pac device
    zone_index_tasks = 60;
    if(check_if_iOS_version_greater_than_or_equal_to("13.5.1") && check_if_iOS_version_less_then("13.5.2")){
        HARDCODED_infoleak_addr = 0xFFFFFFF006D98EF8;
        HARDCODED_allproc = 0xFFFFFFF00776D960;
        HARDCODED_kernel_map = 0xfffffff0070d0a78;
    }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.7.1")){
         zone_index_tasks = 60;
        HARDCODED_infoleak_addr = 0xFFFFFFF006D98EF8;
        HARDCODED_allproc = 0xFFFFFFF007770FA0;
        HARDCODED_kernel_map = 0xfffffff0070d0a90;
    }
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1;
    }
    return 0;
}

#pragma mark ---  iPhone6sPlus

int apply_to_iPhone6sp(){
    
    OFFSET_task_t_flags13 = 0x3B8; // take from iphoneX 13.2.x, think it remains the same in all non-pac device
    zone_index_tasks = 60;
    if(check_if_iOS_version_greater_than_or_equal_to("13.5.1") && check_if_iOS_version_less_then("13.5.2")){
        HARDCODED_infoleak_addr = 0xFFFFFFF006E66238;//6s+ 13.5.1
        HARDCODED_allproc = 0xFFFFFFF00772D950;
        HARDCODED_kernel_map = 0xfffffff007094cd8;
    }
    else if(check_if_iOS_version_greater_than_or_equal_to("13.6") && check_if_iOS_version_less_then("13.7.1")){
         zone_index_tasks = 60;
        HARDCODED_infoleak_addr = 0xFFFFFFF006E66238;
        HARDCODED_allproc = 0xFFFFFFF00772CF90;
        HARDCODED_kernel_map = 0xfffffff007094cf0;
//        fffffff007094cf0 6s+ 13.7 kmemmap
    }
    else{
        printf("Execution pause: require update hardcoded addresses and offsets\n");
        return -1;
    }
    return 0;
}


